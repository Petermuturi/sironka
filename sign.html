<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="sironka.css"/>
         <link rel="stylesheet" type="text/css" href="materialize/css/materialize.min.css"/>
        <link href='http://fonts.googleapis.com/css?family=Raleway:200,400,600' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="parse.css"/>
<title>Sign In|Sironka</title>
<script type="text/javascript" src="sironka.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>
<script src="//www.parsecdn.com/js/parse-1.6.2.min.js"></script>
</head>
<body ng-app="AuthApp">
<div ng-hide="currentUser">
    <form ng-show="scenario == 'Sign up'" name="signup" action="" onSubmit="return validation_for_signup()" method="post">
<ul>

<li>
<p>Username:</p>
<p><input type="text" name="username" value="" ng-model="user.username" size="50" /></p></li>
<li>
<p>Email:</p>
<p><input type="text" name="email"  value="" ng-model="user.email" size="50" /></p></li>

<li><p>Password:</p>
<p><input type="password" name="password"  value="" ng-model="user.password" size="50" /></p></li>
<li>
<p>Password Confirm:</p>
<p><input type="password" name="passconf"  value="" ng-model="user.passconf" size="50" /></p></li>
<li>
<p>First Name:</p>
<p><input type="text" name="firstname"  value="" ng-model="user.firstname" size="50" /></p></li>
<li>
<p>Last Name:</p>
<p><input type="text" name="lastname"  value="" ng-model="user.lastname" size="50" /></p></li>
<li>
<p>Phone:</p>
<p><input type="text" name="phone"  value="" ng-model="user.phone" size="50" /></p></li>
<li>
  <a href="index.html" ng-click="signUp(user)">Sign up</a>
      or <a href="#" ng-click='scenario="Log in"'>Log in</a>
</li></ul>
</form>

    
    <form ng-show="scenario == 'Log in'">
      <h2>Log in</h2>
      Username: <input type="text" ng-model="user.username" /><br />
      Password: <input type="password" ng-model="user.password" /><br />
     <a ng-click="logIn(user)"  href="#"> Log in</a>
      or <a href="#" ng-click='scenario="Sign up"'>Sign up</a>
    </form>
  </div>
  
  <div ng-show="currentUser">
    <h1>Welcome {{currentUser.get('username')}}</h1>
    <p> You have been successfully logged in</p>
    <button ng-click="logOut(user)">Log out</button>
  </div>
</body>
<script type="text/javascript">
    angular.module('AuthApp', [])
.run(['$rootScope', function($scope) {
  $scope.scenario = 'Sign up';
  $scope.currentUser = Parse.User.current();
  
  $scope.signUp = function(form) {
     var user = new Parse.User();
user.set("username", form.username);
user.set("email", form.email);
user.set("password", form.password);
user.set("confirm", form.passconf);
user.set("firstname", form.firstname);
user.set("lastname", form.lastname);
user.set("phone", form.phone);
    
    user.signUp(null, {
      success: function(user) {
        $scope.currentUser = user;
        $scope.$apply();
      },
      error: function(user, error) {
        alert("Unable to sign up:  " + error.code + " " + error.message);
      }
    });    
  };
  
  $scope.logIn = function(form) {
    Parse.User.logIn(form.username, form.password, {
      success: function(user) {
        $scope.currentUser = user;
        $scope.$apply();
      },
      error: function(user, error) {
        alert("Unable to log in: " + error.code + " " + error.message);
      }
    });
  };
  
  $scope.logOut = function(form) {
    Parse.User.logOut();
    $scope.currentUser = null;
  };
}]);

</script>
<script type="text/javascript">
  Parse.initialize("enNfvaZh8DCXVXxhnJKTSI3pj8P4rILSGHnlmX2w", "3iCBpsYvGi3SYKI8XyBOUMkzOw7SmYwPN8S4GhwX");


  
// other fields can be set just like with Parse.Object

  
user.signUp(null, {
  success: function(user) {
    // Hooray! Let them use the app now.
  },
  error: function(user, error) {
    // Show the error message somewhere and let the user try again.
    alert("Error: " + error.code + " " + error.message);
  }
});
  </script>
</html>